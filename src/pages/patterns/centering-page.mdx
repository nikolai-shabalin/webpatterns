import Layout from '../../layouts/Layout.astro';
import Description from '../../components/Patterns/Description.astro';
import DiscussOnGitHub from '../../components/DiscussOnGitHub.astro';
import './_centering-page.css';

<Layout>
  # Центрирование страницы

  <Description>
    Этот паттерн позволяет центрировать контент на странице с помощью CSS, используя функцию `max()` и `margin-inline` для создания адаптивных отступов.
  </Description>

  ## Код паттерна
  ```css
    .container {
      margin-inline: max(20px, (100% - 960px) / 2);
    }
  ```

  ## Постановка задачи
  Нужно центрировать контентный блок так, чтобы:
  - на узких экранах у него были стабильные боковые отступы по `20px`;
  - на широких — блок оставался по центру и не «растягивался» шире `960px`;
  - решение было декларативным, без медиазапросов и лишних обёрток, корректно работало в LTR/RTL.

  ## Традиционный подход («старый способ»)
  Чаще всего делали так:
  ```css
  .container {
    margin: 0 auto; /* центрируем блок */
    max-width: 960px; /* ограничиваем ширину */
  }

  body {
  /* добавляем отступы по бокам
  * чтобы контент не прилипал к краям экрана
    */
    padding: 0 20px;
  }
  ```

  Далее в зависимости от конкретной задачи решение могло быть немного видоизменено, например если у блока должен быть фоновый цвет. В этом случае у `body` обнуляли отступы и переносили их на `container`. Это не пуленепробиваемое решение, так как мешала full-bleed-эффектам, но в целом решение рабочее.

  ```css
  body {
    padding: 0;
    margin: 0;
  }

  .container {
    padding: 20px;
    margin: 0 auto;
    max-width: 960px;
  }
  ```

  ## Современный подход
  ```css
  .container {
    margin-inline: max(20px, (100% - 960px) / 2);
  }
  ```

  Эта запись одновременно создаёт минимальные боковые поля `20px` и центрирует контент, когда места больше чем `960px`.

  ### Пошаговый разбор выражения
  1. `margin-inline`

      Логическое свойство, задаёт оба боковых внешних отступа: начало и конец строки (вместо `margin-left/right`). Оно учитывает направление письма (LTR/RTL), поэтому правило универсально.

    <img src="/centering-page/margin-inline.png" width="1200" height="370" alt="margin-inline с указанием направления письма" />

  2. `max()`

      Функция берёт наибольшее из двух значений. Нам нужно «не меньше, чем 20 px», но если свободного пространства больше — использовать большую величину для центрирования.

    <img src="/centering-page/margin-inline-what-size.png" width="1200" height="370" alt="Какой размер у отступа слева и справа?" />

      - **A** = `20px` — нижняя граница боковых полей на узких экранах.
      <img style="display: block; margin-inline: auto" src="/centering-page/margin-inline-mobile-size.png" width="480" height="250" alt="На мобильном размер будет минимальным 20px" />
      - **B** = `(100% - 960px) / 2` — половина «лишней» ширины контейнера относительно `960px`.

      <figure>
        <img src="/centering-page/margin-inline-full-size.png" width="1200" height="370" alt="Весь размер окна 1200px" />
        <figcaption>
          Для удобного расчёта представим, что размер всего сайта `1200px` (100%).
        </figcaption>
      </figure>
      <figure>
        <img src="/centering-page/margin-inline-more-size.png" width="1200" height="370" alt="Размер оставшейся части 100% - 960 = 240px" />
        <figcaption>
          Оставшаяся часть сайта равна: `100% - 960px = 240px`. Вместо 1200px используем `100%`, так как это ширина всего сайта на любом размере экрана.
        </figcaption>
      </figure>
      <figure>
        <img src="/centering-page/margin-inline-half-size.png" width="1200" height="370" alt="Половина оставшейся части 240px / 2 = 120px" />
        <figcaption>
          Половина оставшейся части сайта равна: `240px / 2 = 120px`. Это и будет отступ слева и справа.
        </figcaption>
      </figure>
        <figure>
        <img src="/centering-page/margin-inline-final-size.png" width="1200" height="370" alt="half" />
        <figcaption>
          Итоговое значение отступа слева и справа: `max(20px, 120px) = 120px`.
        </figcaption>
      </figure>

  3) Какое итоговое значение будет у `max()`: `(100% - 960px) / 2`

      Пусть `W` — ширина содержащего блока.

      - Если `W ≤ 960px`, то `W - 960px ≤ 0`, а значит выражение даёт `0` или отрицательное число → берём `max` с `20px` ⇒ получаем `20px`.
      - Если `W > 960px`, то `(W - 960px) / 2` — это ровно тот отступ слева и справа, который центрирует блок шириной `960px`.

  4) Точка переключения

      Решим, когда оба аргумента равны:
      ```css
      max(20px, (100% - 960px) / 2) = 20px
      ```
      - При `W < 1000px` → берём `20px`.
      - При `W ≥ 1000px` → берём `(W − 960) / 2`.

      Почему `1000px`? Потому что `960px + (20px * 2) = 1000px`.

    Итого, поведение полностью описывается одной формулой, без `@media`.

  ## Примеры использования
  ### Пример №1: Базовый пример
  Добавьте в проект класс `.container` и примените его к блоку, который нужно центрировать.

  ```css
  .container {
    margin-inline: max(20px, (100% - 960px) / 2);
  }
  ```

  ```html
  <div class="container">
    <p>
      Я очень современный блок. Мне звонили из Баленсиаги, а я не взял трубку, так как выше этого.
    </p>
  </div>
  ```

  <figure>
    <div class="block">
      <p>
        Я очень современный блок. Мне звонили из Баленсиаги, а я не взял трубку, так как выше этого.
      </p>
    </div>

    <figcaption>
      Пример №1. Базовый пример
    </figcaption>
  </figure>


  ### Пример №2: С использованием кастомных свойств
  Если в проекте используются кастомные свойства, то можно использовать их для центрирования. Статичные значения в этом случае можно пернести на кастомные свойства.

  ```css
  .container {
    --container-width: 960px;
    --gutter: 20px;
    margin-inline: max(var(--gutter), (100% - var(--container-width)) / 2);
  }
  ```

  ## Поддержка браузеров
  Поддержка браузеров:
  - Chrome 87+ (из-за `margin-inline`)
  - Firefox 75+ (из-за `max()`)
  - Safari 14.1+ (из-за `margin-inline`)

  ## Обсудить паттерн
  <DiscussOnGitHub href="https://github.com/nikolai-shabalin/webpatterns/discussions/2" />
</Layout>
